var v=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var F=(s,a)=>{for(var e in a)v(s,e,{get:a[e],enumerable:!0})},E=(s,a,e,i)=>{if(a&&typeof a=="object"||typeof a=="function")for(let t of w(a))!m.call(s,t)&&t!==e&&v(s,t,{get:()=>a[t],enumerable:!(i=g(a,t))||i.enumerable});return s};var k=s=>E(v({},"__esModule",{value:!0}),s);var y={};F(y,{default:()=>f});module.exports=k(y);var p=require("obsidian"),o="folder-files-view",u=class extends p.ItemView{constructor(e){super(e);this.currentFolderPath=null}getViewType(){return o}getDisplayText(){return"\uD3F4\uB354 \uD30C\uC77C \uBAA9\uB85D"}getIcon(){return"lucide-folder-closed"}async onOpen(){this.updateView()}async onClose(){}updateView(){let e=this.containerEl.children[1];e.empty();let i=this.app.workspace.getActiveFile();if(!i){e.createEl("div",{text:"\uD30C\uC77C\uC744 \uC5F4\uC5B4\uC8FC\uC138\uC694",cls:"folder-files-empty"});return}let t=i.parent?.path||"";this.currentFolderPath=t;let n=this.app.vault.getFiles().filter(r=>(r.parent?.path||"")===t).sort((r,h)=>h.stat.mtime-r.stat.mtime),c=e.createEl("div",{cls:"folder-files-list"});if(n.length===0){c.createEl("div",{text:"\uC774 \uD3F4\uB354\uC5D0 \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4",cls:"folder-files-empty"});return}n.forEach(r=>{let d=c.createEl("div",{cls:"tree-item nav-file"}).createEl("div",{cls:"tree-item-self is-clickable nav-file-title"});r.path===i.path&&d.addClass("is-active"),d.createEl("div",{text:r.basename,cls:"tree-item-inner nav-file-title-content"}),d.addEventListener("click",async()=>{await this.app.workspace.getLeaf().openFile(r)})})}updateHighlight(){let e=this.app.workspace.getActiveFile();if(!e)return;this.containerEl.children[1].querySelectorAll(".nav-file-title").forEach(l=>{let n=l.querySelector(".nav-file-title-content");if(!n)return;let c=n.textContent;l.removeClass("is-active"),c===e.basename&&l.addClass("is-active")})}},f=class extends p.Plugin{constructor(){super(...arguments);this.previousFolderPath=null}async onload(){this.registerView(o,e=>new u(e)),this.addCommand({id:"open-left",name:"\uC67C\uCABD \uC0AC\uC774\uB4DC\uBC14\uC5D0 \uC5F4\uAE30",callback:()=>{this.activateView("left")}}),this.addCommand({id:"open-right",name:"\uC624\uB978\uCABD \uC0AC\uC774\uB4DC\uBC14\uC5D0 \uC5F4\uAE30",callback:()=>{this.activateView("right")}}),this.addCommand({id:"close-view",name:"\uBDF0 \uB2EB\uAE30",callback:()=>{this.closeView()}}),this.registerEvent(this.app.workspace.on("file-open",e=>{e&&this.updateAllViews(e)})),this.registerEvent(this.app.vault.on("delete",e=>{if(e instanceof p.TFile){let i=this.app.workspace.getActiveFile();i&&this.updateAllViews(i)}})),this.registerEvent(this.app.vault.on("rename",(e,i)=>{if(e instanceof p.TFile){let t=this.app.workspace.getActiveFile();t&&this.updateAllViews(t)}}))}onunload(){this.app.workspace.detachLeavesOfType(o)}async activateView(e){let{workspace:i}=this.app,t=null,l=i.getLeavesOfType(o);l.length>0?t=l[0]:(e==="left"?t=i.getLeftLeaf(!1):t=i.getRightLeaf(!1),t&&await t.setViewState({type:o,active:!0})),t&&i.revealLeaf(t)}closeView(){let{workspace:e}=this.app;e.getLeavesOfType(o).forEach(t=>{t.detach()})}updateAllViews(e){let i=e.parent?.path||"",t=this.previousFolderPath!==i;this.previousFolderPath=i,this.app.workspace.getLeavesOfType(o).forEach(n=>{let c=n.view;t?c.updateView():c.updateHighlight()})}};
