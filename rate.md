# 폴더 보기 플러그인 코드 평가

## 정확성 평가 (5점 만점)

**점수: 4.0 / 5.0**

### 잘 구현된 부분
- ✅ 현재 활성 파일의 폴더 경로를 정확하게 파악
- ✅ 같은 폴더의 파일들을 올바르게 필터링
- ✅ 수정 시간 기준 정렬 정확하게 동작
- ✅ 현재 활성 파일 하이라이트 표시
- ✅ 파일 클릭 시 열기 기능 정상 작동
- ✅ 사이드바 열기/닫기 명령어 구현
- ✅ 파일 생성/삭제/이름변경 이벤트 감지

### 개선이 필요한 부분
- ⚠️ 파일 생성/삭제/이름변경 이벤트가 현재 폴더와 무관하게 발생해도 뷰를 업데이트하려고 시도함 (비효율적이지만 기능적으로는 문제없음)
- ⚠️ 폴더 변경 최적화 로직(previousFolderPath)이 파일 오픈 시에만 적용되고 다른 이벤트에는 적용되지 않음

---

## 간결성 평가 (5점 만점)

**점수: 3.5 / 5.0**

### 잘된 부분
- ✅ 전체적으로 이해하기 쉬운 구조
- ✅ 적절한 주석 사용
- ✅ 함수 분리가 명확함 (updateView, updateHighlight)

### 개선 가능한 부분
- ⚠️ create, delete, rename 이벤트 핸들러가 거의 동일한 코드를 중복하여 포함
- ⚠️ 각 이벤트 핸들러마다 activeFile을 가져오고 updateAllViews를 호출하는 패턴이 반복됨
- ⚠️ 하나의 공통 함수로 리팩토링하면 더 간결해질 수 있음

---

## UX 문제점

### 문제 1: 불필요한 전체 리렌더링
**현상:**
- 현재 보고 있는 폴더에 파일이 추가되거나 삭제되면 파일 목록이 순간적으로 깜빡이며 다시 그려짐

**원인이 되는 로직:**
- 파일 생성, 삭제, 이름 변경 이벤트가 발생하면 현재 활성화된 파일을 기준으로 updateAllViews를 호출함
- updateAllViews 함수는 폴더 경로가 바뀌었는지 확인한 후, 바뀌지 않았으면 하이라이트만 업데이트하고 바뀌었으면 전체를 다시 그림
- 하지만 파일 생성/삭제 이벤트에서는 폴더 경로가 바뀐 것이 아니라 같은 폴더 안의 파일 개수가 변한 것이므로, 폴더 경로 비교만으로는 "목록을 다시 그려야 하는지"를 판단할 수 없음
- 결과적으로 같은 폴더에서 파일이 추가/삭제되어도 previousFolderPath는 동일하므로 하이라이트만 업데이트되고, 새로운 파일이 목록에 나타나지 않거나 삭제된 파일이 여전히 보일 수 있음

### 문제 2: 다른 폴더의 변경사항에도 반응
**현상:**
- 사용자가 A 폴더의 파일을 보고 있는데, B 폴더에서 파일을 생성/삭제/이름변경하면 불필요하게 뷰 업데이트 로직이 실행됨

**원인이 되는 로직:**
- create, delete, rename 이벤트 리스너는 Vault 전체의 파일 변경을 감지함
- 이벤트가 발생하면 변경된 파일이 어느 폴더에 속하는지 확인하지 않고, 무조건 현재 활성 파일의 폴더를 기준으로 뷰를 업데이트함
- 예를 들어 현재 "프로젝트/개발" 폴더를 보고 있는데 "일기/2025" 폴더에 파일을 만들어도 updateAllViews가 호출됨
- 결과적으로는 폴더 경로가 다르므로 실제 화면에 영향은 없지만, 불필요한 연산이 수행됨

### 문제 3: 파일 수정 시 정렬 순서가 실시간 반영되지 않음
**현상:**
- 현재 폴더의 파일을 수정하면 수정 시간이 변경되지만, 목록의 정렬 순서가 자동으로 업데이트되지 않음
- 다른 파일로 이동했다가 돌아와야 정렬이 업데이트됨

**원인이 되는 로직:**
- 파일의 수정 시간(mtime)이 변경되는 것을 감지하는 이벤트 리스너가 없음
- 현재 구현된 이벤트는 file-open(파일 열기), create(생성), delete(삭제), rename(이름변경)만 있음
- 파일 내용을 편집하고 저장해도 이 이벤트들은 발생하지 않으므로 뷰가 업데이트되지 않음
- 정렬은 mtime 기준인데, mtime 변경을 감지하지 못하므로 정렬 순서가 실제 수정 시간과 일치하지 않을 수 있음

### 문제 4: 초기 로딩 시 빈 화면
**현상:**
- 플러그인을 처음 활성화했을 때 아무 파일도 열려있지 않으면 "파일을 열어주세요" 메시지만 표시됨

**원인이 되는 로직:**
- updateView 함수는 getActiveFile()이 null을 반환하면 안내 메시지만 표시하고 종료함
- 초기 상태에서 활성 파일이 없는 것은 정상이지만, 사용자 입장에서는 플러그인이 제대로 작동하는지 확인하기 어려움
- 대안으로 최근에 사용한 파일들이나 특정 폴더의 파일들을 보여줄 수도 있지만, 현재는 그런 폴백 로직이 없음
